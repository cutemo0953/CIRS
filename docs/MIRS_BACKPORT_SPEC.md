# MIRS åŠŸèƒ½ç§»æ¤è¦æ ¼æ›¸

**Version:** 1.0
**Date:** 2025-12-12
**Status:** Draft
**Scope:** å¾ CIRS/HIRS ç§»æ¤åŠŸèƒ½åˆ° MIRS

---

## 1. Why We Need This (ç‚ºä»€éº¼åšé€™ä»¶äº‹)

### 1.1 èƒŒæ™¯

MIRS (Medical Inventory & Resilience System) æ˜¯é‡å°é†«ç™‚ç«™è¨­è¨ˆçš„ç‰©è³‡ç®¡ç†ç³»çµ±ã€‚åœ¨ CIRS å’Œ HIRS çš„é–‹ç™¼éç¨‹ä¸­ï¼Œæˆ‘å€‘ç´¯ç©äº†è¨±å¤šã€Œç½é›£ç¾å ´å¯¦ç”¨æ€§ã€çš„ç¶“é©—ï¼š

- **CIRS**: ç¤¾å€ç‰©è³‡ç«™çš„ç™¼æ”¾æµç¨‹ã€çµ„å¥—æ©Ÿåˆ¶ã€å‚™ä»½ç®¡ç†
- **HIRS**: ç¶­ç”Ÿå¤©æ•¸è¨ˆç®—ã€ç‰©è³‡åŒ…æ¦‚å¿µã€ç›´è¦ºåŒ– UI

é€™äº›åŠŸèƒ½ç¶“éã€Œå¯¦éš›ä½¿ç”¨æƒ…å¢ƒã€é©—è­‰ï¼Œæ‡‰è©²åå“ºå› MIRSã€‚

### 1.2 MIRS çš„ç‰¹æ®Šéœ€æ±‚

é†«ç™‚ç«™èˆ‡ç¤¾å€ç«™çš„å·®ç•°ï¼š

| é¢å‘ | CIRS (ç¤¾å€) | MIRS (é†«ç™‚) |
|------|------------|-------------|
| ä½¿ç”¨è€… | å¿—å·¥ | é†«è­·äººå“¡ |
| å°ˆæ¥­åº¦ | ä½ | é«˜ |
| æ™‚é–“å£“åŠ› | ä¸­ | æ¥µé«˜ |
| ç‰©è³‡é¡å‹ | ç”Ÿæ´»ç‰©è³‡ | é†«ç™‚è€—æã€è—¥å“ |
| å¤±èª¤å®¹å¿åº¦ | ä¸­ | æ¥µä½ |
| IT èƒ½åŠ› | ä½ | ä½ï¼ˆé†«è­·é ITï¼‰ |

å› æ­¤ï¼Œç§»æ¤åŠŸèƒ½æ™‚éœ€è¦è€ƒé‡ï¼š
1. **æ›´å¿«çš„æ“ä½œ** - é†«è­·äººå“¡æ²’æ™‚é–“é»å¾ˆå¤šæ­¥é©Ÿ
2. **æ›´å°‘çš„éŒ¯èª¤** - ç™¼éŒ¯è—¥å¯èƒ½è‡´å‘½
3. **æ›´å¼·çš„è‡ªæ•‘èƒ½åŠ›** - ç³»çµ±æ›äº†è¦èƒ½è‡ªå·±ä¿®

---

## 2. ç§»æ¤åŠŸèƒ½æ¸…å–®

### å„ªå…ˆç´šå®šç¾©

| ç­‰ç´š | èªªæ˜ |
|------|------|
| P0 | å¿…åšï¼Œå½±éŸ¿ç³»çµ±å­˜æ´» |
| P1 | æ‡‰åšï¼Œé¡¯è‘—æå‡æ•ˆç‡ |
| P2 | å¯åšï¼ŒéŒ¦ä¸Šæ·»èŠ± |
| P3 | ä¸åšï¼Œä¸é©åˆé†«ç™‚å ´æ™¯ |

### åŠŸèƒ½è©•ä¼°

| åŠŸèƒ½ | ä¾†æº | å„ªå…ˆç´š | ç†ç”± |
|------|------|--------|------|
| ç¶²é ç‰ˆå‚™ä»½ç®¡ç† | CIRS | **P0** | é†«ç™‚ç«™ä¸èƒ½åœæ©Ÿï¼Œå¿…é ˆèƒ½è‡ªæ•‘ |
| è™•ç½®åŒ… (Procedure Kits) | CIRS çµ„å¥— | **P1** | ä¸€éµæ‰£åº«ï¼Œç¯€çœé†«è­·æ™‚é–“ |
| æ¶ˆè€—ç‡é è­¦ | HIRS | **P1** | æ±ºç­–æ”¯æ´ï¼Œææ—©èª¿æ’¥ |
| Portal ç‹€æ…‹çœ‹æ¿ | CIRS | **P2** | å€™è¨ºå€è³‡è¨Šï¼Œä½†æœ‰è² è¼‰ç–‘æ…® |
| ç¤¾ç¾¤åˆ†äº« | HIRS | **P3** | é†«ç™‚ç‰©è³‡ä¸é©åˆç¤¾ç¾¤åˆ†äº« |
| ç•™è¨€æ¿ | - | **P3** | é†«ç™‚ç«™é å–Šå’Œå°è¬›æ©Ÿï¼Œä¸æœƒæ‰“å­— |

---

## 3. P0: ç¶²é ç‰ˆå‚™ä»½ç®¡ç†

### 3.1 Why

**ç¾ç‹€å•é¡Œï¼š**
- MIRS å‚™ä»½å¯èƒ½ä¾è³´ CLI æˆ– Cron Job
- é†«å¸«/è­·ç†é•·ä¸æœƒç”¨ SSH
- ç³»çµ±æ›äº†åªèƒ½ç­‰å·¥ç¨‹å¸«

**ç›®æ¨™ï¼š**
- éæŠ€è¡“äººå“¡ä¹Ÿèƒ½ä¸€éµå‚™ä»½/é‚„åŸ
- æ¸›å°‘å°å·¥ç¨‹å¸«çš„ä¾è³´

### 3.2 åŠŸèƒ½è¦æ ¼

**ä½ç½®ï¼š** ç³»çµ±è¨­å®š â†’ è³‡æ–™ç¶­è­·

**UI è¨­è¨ˆï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è³‡æ–™ç¶­è­·                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  â”Œâ”€ å‚™ä»½ç®¡ç† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  ä¸Šæ¬¡å‚™ä»½ï¼š2025-12-12 08:30                         â”‚   â”‚
â”‚  â”‚  å‚™ä»½ä½ç½®ï¼š/media/usb/mirs_backup/                  â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  [ ç«‹å³å‚™ä»½åˆ° USB ]                                 â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  â”€ æˆ–å¾ USB é‚„åŸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  å¯ç”¨å‚™ä»½ï¼š                                         â”‚   â”‚
â”‚  â”‚  â—‹ mirs_backup_20251212_0830.db (12.3 MB)          â”‚   â”‚
â”‚  â”‚  â—‹ mirs_backup_20251211_1800.db (11.9 MB)          â”‚   â”‚
â”‚  â”‚  â—‹ mirs_backup_20251210_0800.db (11.5 MB)          â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  [ é‚„åŸé¸ä¸­çš„å‚™ä»½ ]                                 â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€ å±éšªæ“ä½œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  [ é‡ç½®è³‡æ–™åº« ]  â† éœ€è¼¸å…¥ PIN ç¢¼ç¢ºèª                â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 Backend API

```python
# /api/system/backup
POST /api/system/backup
# åŸ·è¡Œå‚™ä»½åˆ° USB
# Response: { "success": true, "filename": "mirs_backup_xxx.db" }

GET /api/system/backup/list
# åˆ—å‡º USB ä¸Šçš„å‚™ä»½æª”æ¡ˆ
# Response: { "backups": [{ "filename": "...", "size": 12345, "date": "..." }] }

POST /api/system/restore
# Body: { "filename": "mirs_backup_xxx.db" }
# å¾ USB é‚„åŸ
# Response: { "success": true, "message": "é‚„åŸå®Œæˆï¼Œè«‹é‡æ–°æ•´ç†é é¢" }

POST /api/system/reset
# Body: { "pin": "1234" }
# é‡ç½®è³‡æ–™åº«ï¼ˆå±éšªæ“ä½œï¼‰
```

### 3.4 å®‰å…¨è€ƒé‡

1. **é‚„åŸç¢ºèª** - é‚„åŸå‰é¡¯ç¤ºè­¦å‘Šã€Œç¾æœ‰è³‡æ–™å°‡è¢«è¦†è“‹ã€
2. **é‡ç½® PIN** - é‡ç½®è³‡æ–™åº«éœ€è¦è¼¸å…¥ç®¡ç†å“¡ PIN
3. **è‡ªå‹•å‚™ä»½** - æ¯å¤©å®šæ™‚å‚™ä»½ä¸€æ¬¡ï¼ˆCron Job ä¿ç•™ï¼‰
4. **å‚™ä»½è¼ªæ›¿** - ä¿ç•™æœ€è¿‘ 7 å¤©çš„å‚™ä»½ï¼Œè‡ªå‹•åˆªé™¤èˆŠçš„

---

## 4. P1: è™•ç½®åŒ… (Procedure Kits)

### 4.1 Why

**ç¾ç‹€å•é¡Œï¼š**
- é†«ç”ŸåŸ·è¡Œã€Œç¸«åˆã€è¦æ‰£ï¼šç¸«åˆç·šã€éº»è—¥ã€ç´—å¸ƒã€æ‰‹å¥—...
- é€é …é»é¸å¤ªæ…¢ï¼Œå¤§é‡å‚·æ‚£æ™‚æ ¹æœ¬ä¾†ä¸åŠ
- å®¹æ˜“æ¼æ‰£ï¼Œå°è‡´åº«å­˜ä¸æº–

**ç›®æ¨™ï¼š**
- ä¸€éµåŸ·è¡Œè™•ç½®ï¼Œè‡ªå‹•æ‰£é™¤æ‰€æœ‰ç›¸é—œç‰©è³‡
- æ¨™æº–åŒ–è™•ç½®æµç¨‹ï¼Œæ¸›å°‘äººç‚ºç–å¤±

### 4.2 æ¦‚å¿µå®šç¾©

**è™•ç½®åŒ… (Procedure Kit)** = åŸ·è¡ŒæŸé …é†«ç™‚è™•ç½®æ‰€éœ€çš„ç‰©è³‡çµ„åˆ

| è™•ç½®åŒ…åç¨± | åŒ…å«ç‰©è³‡ |
|-----------|---------|
| ç¸«åˆåŒ… | ç¸«åˆç·š x1, å±€éƒ¨éº»é†‰ x1, ç´—å¸ƒ x2, ç„¡èŒæ‰‹å¥— x1 |
| IV è¼¸æ¶²åŒ… | é»æ»´è¢‹ x1, ç•™ç½®é‡ x1, è¼¸æ¶²ç®¡ x1, è† å¸¶ x1 |
| å‚·å£æ¸…æ½”åŒ… | ç”Ÿç†é£Ÿé¹½æ°´ x1, ç´—å¸ƒ x5, ç¢˜é…’æ£‰æ£’ x2, æ‰‹å¥— x1 |
| éª¨æŠ˜å›ºå®šåŒ… | å¤¾æ¿ x2, å½ˆæ€§ç¹ƒå¸¶ x3, ä¸‰è§’å·¾ x1 |

### 4.3 UI è¨­è¨ˆ

**ä½ç½®ï¼š** é¦–é å¿«é€Ÿæ“ä½œå€ æˆ– ç¨ç«‹çš„ã€Œè™•ç½®ã€Tab

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¿«é€Ÿè™•ç½®                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   ğŸ©¹     â”‚  â”‚   ğŸ’‰     â”‚  â”‚   ğŸ§´     â”‚  â”‚   ğŸ¦´     â”‚   â”‚
â”‚  â”‚  ç¸«åˆ    â”‚  â”‚  IVè¼¸æ¶²  â”‚  â”‚  æ¸…æ½”    â”‚  â”‚  å›ºå®š    â”‚   â”‚
â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚   â”‚
â”‚  â”‚  [åŸ·è¡Œ]  â”‚  â”‚  [åŸ·è¡Œ]  â”‚  â”‚  [åŸ·è¡Œ]  â”‚  â”‚  [åŸ·è¡Œ]  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                            â”‚
â”‚  é»æ“Šã€ŒåŸ·è¡Œã€æœƒè‡ªå‹•æ‰£é™¤è©²è™•ç½®åŒ…çš„æ‰€æœ‰ç‰©è³‡                    â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŸ·è¡Œç¢ºèªå°è©±æ¡†ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸ·è¡Œã€Œç¸«åˆã€è™•ç½®ï¼Ÿ                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚  å°‡æ‰£é™¤ä»¥ä¸‹ç‰©è³‡ï¼š                       â”‚
â”‚                                        â”‚
â”‚  âœ“ ç¸«åˆç·š      1 çµ„   (åº«å­˜: 23)       â”‚
â”‚  âœ“ å±€éƒ¨éº»é†‰    1 æ”¯   (åº«å­˜: 15)       â”‚
â”‚  âœ“ ç„¡èŒç´—å¸ƒ    2 ç‰‡   (åº«å­˜: 120)      â”‚
â”‚  âš  ç„¡èŒæ‰‹å¥—    1 é›™   (åº«å­˜: 2) â†ä½    â”‚
â”‚                                        â”‚
â”‚  [ å–æ¶ˆ ]           [ ç¢ºèªåŸ·è¡Œ ]       â”‚
â”‚                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 è™•ç½®åŒ…ç®¡ç†

**ä½ç½®ï¼š** è¨­å®š â†’ è™•ç½®åŒ…ç®¡ç†

åŠŸèƒ½ï¼š
- æ–°å¢/ç·¨è¼¯/åˆªé™¤è™•ç½®åŒ…
- è¨­å®šè™•ç½®åŒ…å…§å®¹ï¼ˆç‰©è³‡ + æ•¸é‡ï¼‰
- åŒ¯å…¥é è¨­è™•ç½®åŒ…ç¯„æœ¬

### 4.5 Backend API

```python
# è™•ç½®åŒ… CRUD
GET /api/procedure-kits
POST /api/procedure-kits
PUT /api/procedure-kits/{id}
DELETE /api/procedure-kits/{id}

# åŸ·è¡Œè™•ç½®ï¼ˆæ‰£åº«å­˜ï¼‰
POST /api/procedure-kits/{id}/execute
# Response: {
#   "success": true,
#   "deducted": [{ "item": "ç¸«åˆç·š", "qty": 1 }, ...],
#   "warnings": ["ç„¡èŒæ‰‹å¥—åº«å­˜åä½ (å‰© 2)"]
# }
```

### 4.6 è³‡æ–™çµæ§‹

```json
{
  "id": "proc-001",
  "name": "ç¸«åˆåŒ…",
  "icon": "ğŸ©¹",
  "description": "åŸºæœ¬ç¸«åˆè™•ç½®",
  "items": [
    { "item_id": 101, "name": "ç¸«åˆç·š", "qty": 1 },
    { "item_id": 102, "name": "å±€éƒ¨éº»é†‰", "qty": 1 },
    { "item_id": 103, "name": "ç„¡èŒç´—å¸ƒ", "qty": 2 },
    { "item_id": 104, "name": "ç„¡èŒæ‰‹å¥—", "qty": 1 }
  ],
  "created_at": "2025-12-12T10:00:00+08:00",
  "updated_at": "2025-12-12T10:00:00+08:00"
}
```

---

## 5. P1: æ¶ˆè€—ç‡é è­¦ (Burn Rate Alert)

### 5.1 Why

**ç¾ç‹€å•é¡Œï¼š**
- çœ‹åˆ°ã€ŒæŠ—ç”Ÿç´ å‰© 100 é¡†ã€æ²’æœ‰æ„Ÿè¦º
- ä¸çŸ¥é“ã€Œä»¥ç›®å‰é€Ÿåº¦ï¼Œå¤šä¹…æœƒç”¨å®Œã€
- ç­‰åˆ°ç”¨å®Œæ‰ç™¼ç¾ï¼Œä¾†ä¸åŠèª¿æ’¥

**ç›®æ¨™ï¼š**
- é¡¯ç¤ºã€Œé ä¼° N å°æ™‚å¾Œè€—ç›¡ã€
- ææ—©è§¸ç™¼èª¿æ’¥è­¦å ±

### 5.2 è¨ˆç®—é‚è¼¯

**èˆ‡ HIRS çš„å·®ç•°ï¼š**

| é¢å‘ | HIRS | MIRS |
|------|------|------|
| è¨ˆç®—åŸºæº– | å›ºå®šäººæ•¸ (4äºº) | å‹•æ…‹æ¶ˆè€—ç‡ |
| æ™‚é–“å–®ä½ | å¤© | å°æ™‚ |
| è³‡æ–™ä¾†æº | æ‰‹å‹•è¨­å®š | æ­·å²æ¶ˆè€—è¨˜éŒ„ |

**MIRS è¨ˆç®—å…¬å¼ï¼š**

```
æ¶ˆè€—ç‡ = éå» 3 å°æ™‚æ¶ˆè€—é‡ / 3
é ä¼°è€—ç›¡æ™‚é–“ = ç›®å‰åº«å­˜ / æ¶ˆè€—ç‡
```

**ç‰¹æ®Šæƒ…æ³è™•ç†ï¼š**
- æ¶ˆè€—ç‡ = 0 â†’ é¡¯ç¤ºã€Œç„¡æ¶ˆè€—è¨˜éŒ„ã€
- é ä¼° > 24 å°æ™‚ â†’ é¡¯ç¤ºã€Œ> 1 å¤©ã€
- é ä¼° < 2 å°æ™‚ â†’ ç´…å­—è­¦å‘Š

### 5.3 UI è¨­è¨ˆ

**åº«å­˜åˆ—è¡¨å¢å¼·ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æŠ—ç”Ÿç´  (Amoxicillin)                                       â”‚
â”‚  åº«å­˜: 100 é¡†                                               â”‚
â”‚  ğŸ”¥ é ä¼° 1.5 å°æ™‚å¾Œè€—ç›¡   â† ç´…å­—è­¦å‘Š                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç”Ÿç†é£Ÿé¹½æ°´ 500ml                                           â”‚
â”‚  åº«å­˜: 50 ç“¶                                                â”‚
â”‚  â± é ä¼° 8 å°æ™‚å¾Œè€—ç›¡                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  OKç¹ƒ                                                       â”‚
â”‚  åº«å­˜: 200 ç‰‡                                               â”‚
â”‚  âœ“ é ä¼° > 1 å¤©                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Dashboard è­¦å ±å€ï¼š**

```
â”Œâ”€ è€—ç›¡é è­¦ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                            â”‚
â”‚  ğŸ”´ æŠ—ç”Ÿç´  - é ä¼° 1.5 å°æ™‚å¾Œè€—ç›¡                            â”‚
â”‚  ğŸŸ¡ ç”Ÿç†é£Ÿé¹½æ°´ - é ä¼° 8 å°æ™‚å¾Œè€—ç›¡                          â”‚
â”‚                                                            â”‚
â”‚  [ è«‹æ±‚è·¨ç«™èª¿æ’¥ ]                                          â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.4 Backend

```python
# è¨ˆç®—æ‰€æœ‰ç‰©è³‡çš„è€—ç›¡é ä¼°
GET /api/inventory/burn-rate
# Response: {
#   "items": [
#     { "id": 101, "name": "æŠ—ç”Ÿç´ ", "qty": 100, "burn_rate": 66.7, "hours_remaining": 1.5 },
#     ...
#   ],
#   "alerts": [
#     { "id": 101, "name": "æŠ—ç”Ÿç´ ", "hours_remaining": 1.5, "level": "critical" }
#   ]
# }
```

---

## 6. P2: Portal ç‹€æ…‹çœ‹æ¿

### 6.1 Why

**ä½¿ç”¨å ´æ™¯ï¼š**
- é†«ç™‚ç«™å€™è¨ºå€æœ‰è¢å¹•
- ç½æ°‘æƒ³çŸ¥é“ã€Œé‚„è¦ç­‰å¤šä¹…ã€ã€Œæœ‰æ²’æœ‰æˆ‘éœ€è¦çš„è—¥ã€

**ç–‘æ…®ï¼š**
- æ¨¹è“æ´¾è² è¼‰å•é¡Œ
- å€™è¨ºå€ WiFi é€£ç·šå•é¡Œ

### 6.2 ç²¾ç°¡è¨­è¨ˆ

**åŸå‰‡ï¼šæœ€å°åŒ–ä¼ºæœå™¨è² æ“”**

1. **éœæ…‹ HTML** - ä¸ç”¨ WebSocketï¼Œç”¨ 30 ç§’è¼ªè©¢
2. **æ¥µç°¡å…§å®¹** - åªé¡¯ç¤º 3 é …è³‡è¨Š
3. **å¿«å–å„ªå…ˆ** - è³‡æ–™ 30 ç§’æ›´æ–°ä¸€æ¬¡

**UI è¨­è¨ˆï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                            â”‚
â”‚           ğŸ¥ XXé†«ç™‚ç«™ å³æ™‚ç‹€æ…‹                              â”‚
â”‚                                                            â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚           â”‚                         â”‚                      â”‚
â”‚           â”‚    ğŸŸ¢ å¯æ”¶æ²»            â”‚  â† æˆ– ğŸ”´ æ»¿è¼‰        â”‚
â”‚           â”‚                         â”‚                      â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                            â”‚
â”‚           ç›®å‰å€™è¨ºäººæ•¸ï¼š12 äºº                               â”‚
â”‚                                                            â”‚
â”‚           âš ï¸ ç¼ºè—¥å…¬å‘Šï¼š                                    â”‚
â”‚           - ç ´å‚·é¢¨ç–«è‹—æš«æ™‚ç¼ºè²¨                              â”‚
â”‚                                                            â”‚
â”‚           æœ€å¾Œæ›´æ–°ï¼š10:30:45                                â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 Implementation

**è·¯ç”±ï¼š** `/public/status` (ç„¡éœ€ç™»å…¥)

**Backendï¼š**
```python
GET /api/public/status
# Response: {
#   "status": "open",  # open | full | closed
#   "waiting_count": 12,
#   "announcements": ["ç ´å‚·é¢¨ç–«è‹—æš«æ™‚ç¼ºè²¨"],
#   "updated_at": "2025-12-12T10:30:45+08:00"
# }
```

**Frontendï¼š**
- ç´” HTML + 30 ç§’ `setInterval` è¼ªè©¢
- ç„¡ Alpine.jsï¼Œæ¸›å°‘ JS å¤§å°
- å­—é«”æ”¾å¤§ï¼Œé©åˆé è·é›¢è§€çœ‹

### 6.4 è² è¼‰è©•ä¼°

| é …ç›® | ä¼°ç®— |
|------|------|
| API å›æ‡‰å¤§å° | < 500 bytes |
| è¼ªè©¢é »ç‡ | 30 ç§’ä¸€æ¬¡ |
| åŒæ™‚è§€çœ‹äººæ•¸ | å‡è¨­ 10 äºº |
| API è«‹æ±‚é‡ | 10 Ã— 2/åˆ†é˜ = 20 req/min |
| Pi è² æ“” | æ¥µä½ âœ“ |

---

## 7. ä¸ç§»æ¤çš„åŠŸèƒ½ (P3)

### 7.1 ç¤¾ç¾¤åˆ†äº«

**ç†ç”±ï¼š**
- é†«ç™‚ç‰©è³‡æœ‰å°ˆæ¥­é–€æª»ï¼Œä¸é©åˆã€Œæ¨è–¦çµ¦æœ‹å‹ã€
- è—¥å“ç®¡ç†æœ‰æ³•è¦é™åˆ¶
- é†«ç™‚ç«™ç‰©è³‡æ¸…å–®å¯èƒ½æ¶‰åŠæ•æ„Ÿè³‡è¨Š

### 7.2 ç•™è¨€æ¿/èŠå¤©å®¤

**ç†ç”±ï¼š**
- é†«ç™‚ç«™å…§æºé€šé ã€Œå–Šã€å’Œã€Œç„¡ç·šé›»ã€
- æ€¥æ•‘æ™‚ä¸å¯èƒ½æ‰“å­—
- æœƒè®Šæˆç„¡äººä½¿ç”¨çš„èšŠå­åŠŸèƒ½

### 7.3 è¤‡é›œèº«ä»½ç®¡ç†

**ç†ç”±ï¼š**
- ç—…æ‚£å ±åˆ°æ˜¯ CIRS çš„è·è²¬
- MIRS åªéœ€æƒæ CIRS çµ¦çš„ QR Code å–å¾—ç—…æ‚£ ID
- é¿å… MIRS è®Šæˆé›»å­ç—…æ­·ç³»çµ± (EMR)

---

## 8. Implementation Roadmap

### Phase 1: åŸºç¤è‡ªæ•‘èƒ½åŠ› (P0)
- [ ] å‚™ä»½ç®¡ç† UI
- [ ] æ‰‹å‹•å‚™ä»½åˆ° USB
- [ ] å¾ USB é‚„åŸ
- [ ] è³‡æ–™åº«é‡ç½®ï¼ˆå¸¶ PINï¼‰

### Phase 2: æ•ˆç‡æå‡ (P1)
- [ ] è™•ç½®åŒ…è³‡æ–™çµæ§‹
- [ ] è™•ç½®åŒ… CRUD API
- [ ] è™•ç½®åŒ…ç®¡ç† UI
- [ ] ä¸€éµåŸ·è¡Œè™•ç½®
- [ ] æ¶ˆè€—ç‡è¨ˆç®—é‚è¼¯
- [ ] è€—ç›¡é è­¦ UI

### Phase 3: é¸é…åŠŸèƒ½ (P2)
- [ ] Portal ç‹€æ…‹çœ‹æ¿ï¼ˆè©•ä¼° Pi è² è¼‰å¾Œæ±ºå®šï¼‰

---

## Appendix: ADR

### ADR-006: ç‚ºä»€éº¼ Portal ç”¨è¼ªè©¢è€Œé WebSocketï¼Ÿ

**Context:** Portal ç‹€æ…‹çœ‹æ¿éœ€è¦å³æ™‚æ›´æ–°ã€‚

**Decision:** ä½¿ç”¨ 30 ç§’è¼ªè©¢ï¼Œä¸ç”¨ WebSocketã€‚

**Rationale:**
1. WebSocket éœ€è¦ç¶­æŒé•·é€£ç·šï¼Œå¢åŠ  Pi è² æ“”
2. ç‹€æ…‹è³‡è¨Šä¸éœ€è¦æ¯«ç§’ç´šå³æ™‚æ€§
3. è¼ªè©¢å¯¦ä½œç°¡å–®ï¼Œå‡ºéŒ¯å®¹æ˜“æ’æŸ¥
4. 30 ç§’æ›´æ–°ä¸€æ¬¡å°å€™è¨ºå€è¶³å¤ 

**Consequences:**
- ç‹€æ…‹æ›´æ–°æœ€å¤šå»¶é² 30 ç§’ï¼ˆå¯æ¥å—ï¼‰
- å¯¦ä½œç°¡å–®ï¼Œç¶­è­·æˆæœ¬ä½
- Pi è² è¼‰å¯æ§
