# xIRS Pharmacy Prescription Workflow Spec v1.0

**Version**: 1.0
**Theme**: Complete Clinical Workflow for Disaster Medical Response
**Supplements**: xIRS_LITE_CPOE_SPEC_v1.0.md
**Date**: 2025-12-22
**Status**: Draft

---

## 1. Overview

This document supplements the Lite CPOE Spec by detailing:
- **Nurse workflow** with ä¸‰è®€äº”å° verification
- **Emergency medication protocol** (retroactive documentation)
- **Runner transport protocol**
- **Complete role-based workflows**

---

## 2. Complete Workflow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DISASTER MEDICAL WORKFLOW                                 â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                              â”‚
â”‚  â”‚  Hub Console  â”‚ â”€â”€â”€ é†«å¸«èº«åˆ†é©—è­‰/æ†‘è­‰ç™¼æ”¾ â”€â”€â”                                â”‚
â”‚  â”‚  (Admin PC)   â”‚                              â–¼                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                                           â”‚ Doctor   â”‚                          â”‚
â”‚                                           â”‚  PWA     â”‚                          â”‚
â”‚                                           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                                â”‚                                â”‚
â”‚                                    1. å•è¨º (SOAP-Lite)                          â”‚
â”‚                                    2. é–‹ç«‹è™•æ–¹ (Ed25519 ç°½ç« )                    â”‚
â”‚                                    3. ç”¢ç”Ÿ Rx QR Code                           â”‚
â”‚                                                â”‚                                â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚                         â–¼                      â–¼                     â–¼          â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚                  â”‚ Patient  â”‚           â”‚  Runner  â”‚          â”‚ Patient  â”‚     â”‚
â”‚                  â”‚ (è‡ªè¡Œ)   â”‚           â”‚ (å¿—å·¥)   â”‚          â”‚ (å®¶å±¬)   â”‚     â”‚
â”‚                  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                       â”‚                      â”‚                      â”‚           â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                              â”‚                                  â”‚
â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚                            â”‚       Pharmacy Station PWA        â”‚                â”‚
â”‚                            â”‚ (Pharmacist iPad)                 â”‚                â”‚
â”‚                            â”‚                                   â”‚                â”‚
â”‚                            â”‚ 4. æƒæ Rx QR                      â”‚                â”‚
â”‚                            â”‚ 5. é©—è­‰é†«å¸«ç°½ç«                     â”‚                â”‚
â”‚                            â”‚ 6. æ ¸å°ç—…æ‚£èº«åˆ†                    â”‚                â”‚
â”‚                            â”‚ 7. æª¢æŸ¥åº«å­˜/äº¤äº’ä½œç”¨               â”‚                â”‚
â”‚                            â”‚ 8. èª¿åŠ‘ç™¼è—¥                        â”‚                â”‚
â”‚                            â”‚ 9. ç”¨è—¥æŒ‡å°                        â”‚                â”‚
â”‚                            â”‚ 10. è¨˜éŒ„ DISPENSE_RECORD           â”‚                â”‚
â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                              â”‚                                  â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚            â–¼                                 â–¼                             â–¼   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ å£æœè—¥       â”‚                 â”‚ æ³¨å°„åŠ‘/ç®¡åˆ¶è—¥â”‚              â”‚ å¤–ç”¨è—¥   â”‚â”‚
â”‚     â”‚ ç›´æ¥çµ¦ç—…æ‚£   â”‚                 â”‚ éœ€è­·ç†ç«™çµ¦äºˆ â”‚              â”‚ ç›´æ¥çµ¦   â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                             â”‚                                   â”‚
â”‚                                    Runner é‹é€è‡³è­·ç†ç«™                          â”‚
â”‚                                             â”‚                                   â”‚
â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚                            â”‚      Nurse Station             â”‚                   â”‚
â”‚                            â”‚                                â”‚                   â”‚
â”‚                            â”‚ 11. æƒæç™¼è—¥æ†‘è­‰ QR             â”‚                   â”‚
â”‚                            â”‚ 12. ä¸‰è®€äº”å°é©—è­‰                â”‚                   â”‚
â”‚                            â”‚ 13. çµ¦è—¥/æ³¨å°„                   â”‚                   â”‚
â”‚                            â”‚ 14. è¨˜éŒ„ ADMIN_RECORD           â”‚                   â”‚
â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Role-Based Workflows

### 3.1 Doctor (é†«å¸«)

**Device**: Doctor PWA on Phone/Tablet
**Authentication**: Hub credential with Ed25519 signing key

#### Workflow Steps

| Step | Action | PWA Screen | Data Generated |
|------|--------|------------|----------------|
| 1 | ç™»å…¥ Doctor PWA | èº«åˆ†é©—è­‰ | - |
| 2 | é¸æ“‡/æ–°å¢ç—…æ‚£ | ç—…æ‚£åˆ—è¡¨ | Patient record |
| 3 | å•è¨ºè¨˜éŒ„ (SOAP-Lite) | ç—…æ­·è¼¸å…¥ | SOAP note (optional) |
| 4 | é–‹ç«‹è™•æ–¹ | è™•æ–¹è¼¸å…¥ | RX_ORDER (draft) |
| 5 | ç°½ç« ç¢ºèª | ç¢ºèªç•«é¢ | RX_ORDER (signed) |
| 6 | é¡¯ç¤º QR Code | QR é¡¯ç¤º | - |
| 7 | äº¤ä»˜çµ¦ Runner/Patient | - | - |

#### SOAP-Lite Format (Minimal)

```json
{
  "type": "SOAP_LITE",
  "patient_ref": "***0042",
  "subjective": "ç™¼ç‡’å…©å¤©ã€å–‰åš¨ç—›",
  "objective": "T: 38.2Â°C, å’½å–‰ç´…è…«",
  "assessment": "ä¸Šå‘¼å¸é“æ„ŸæŸ“",
  "plan": "ç—‡ç‹€æ²»ç™‚ï¼Œé–‹ç«‹è™•æ–¹",
  "ts": 1734850000,
  "prescriber_id": "DOC-001"
}
```

### 3.2 Pharmacist (è—¥å¸«)

**Device**: Pharmacy Station PWA on iPad
**Authentication**: Station pairing + pharmacist login

#### Workflow Steps

| Step | Action | UI Element | Verification |
|------|--------|------------|--------------|
| 1 | æƒæ Rx QR | Camera modal | xIRS format check |
| 2 | é©—è­‰é†«å¸«ç°½ç«  | Auto | Ed25519 verify |
| 3 | æª¢æŸ¥é‡è¤‡è™•æ–¹ | Auto | rx_id + nonce |
| 4 | æ ¸å°ç—…æ‚£èº«åˆ† | é¡¯ç¤ºç—…æ‚£è³‡è¨Š | å£é ­ç¢ºèª |
| 5 | æª¢è¦–è™•æ–¹å…§å®¹ | è™•æ–¹è©³æƒ… | è—¥å¸«å¯©æ ¸ |
| 6 | æª¢æŸ¥åº«å­˜ | åº«å­˜ç‹€æ…‹ | æ•¸é‡è¶³å¤  |
| 7 | èª¿åŠ‘è—¥å“ | Checklist | é€é …å‹¾é¸ |
| 8 | **ç®¡åˆ¶è—¥é›™äººç¢ºèª** | è¦‹è­‰äººè¼¸å…¥ | ç¬¬äºŒè—¥å¸« |
| 9 | ç”¨è—¥æŒ‡å° | è¡›æ•™ç´€éŒ„ | å‹¾é¸å®Œæˆ |
| 10 | ç¢ºèªç™¼è—¥ | ç°½æ”¶ç•«é¢ | ç—…æ‚£/Runner ç°½æ”¶ |
| 11 | ç”¢ç”Ÿç™¼è—¥æ†‘è­‰ QR | QR é¡¯ç¤º | For Nurse |

#### Dispense Ticket QR (for Nurse Station)

```json
{
  "type": "DISPENSE_TICKET",
  "version": "1.0",
  "dispense_id": "DISP-PHARM01-20251222-0015",
  "rx_id": "RX-DOC001-20251222-0042",
  "patient_ref": "***0042",
  "items": [
    {
      "code": "MED-CEFTRI-1G",
      "name": "Ceftriaxone 1g",
      "qty": 1,
      "route": "IV",
      "freq": "QD",
      "requires_admin": true
    }
  ],
  "pharmacist_id": "PHARM-001",
  "dispensed_at": 1734855000,
  "valid_until": 1734898200,
  "hmac": "HMAC-SHA256..."
}
```

### 3.3 Nurse (è­·ç†å¸«)

**Device**: Nurse Station (shared terminal or tablet)
**Authentication**: Nurse ID + PIN

#### Workflow: ä¸‰è®€äº”å° (3 Reads, 5 Rights)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ä¸‰è®€äº”å° Verification                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ä¸‰è®€ (3 Reads):                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 1. å–è—¥æ™‚è®€ - å¾è—¥è»Š/å†°ç®±å–å‡ºæ™‚ç¢ºèª                       â”‚   â”‚
â”‚  â”‚ 2. çµ¦è—¥å‰è®€ - æº–å‚™çµ¦è—¥æ™‚å†æ¬¡ç¢ºèª                          â”‚   â”‚
â”‚  â”‚ 3. çµ¦è—¥å¾Œè®€ - æ­¸ä½/ä¸Ÿæ£„å‰æœ€çµ‚ç¢ºèª                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  äº”å° (5 Rights):                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â˜ å°ç—…äºº (Right Patient)   - æ ¸å°ç—…æ‚£èº«åˆ†               â”‚   â”‚
â”‚  â”‚ â˜ å°è—¥ç‰© (Right Drug)      - æ ¸å°è—¥å“åç¨±               â”‚   â”‚
â”‚  â”‚ â˜ å°åŠ‘é‡ (Right Dose)      - æ ¸å°åŠ‘é‡                   â”‚   â”‚
â”‚  â”‚ â˜ å°æ™‚é–“ (Right Time)      - æ ¸å°çµ¦è—¥æ™‚é–“               â”‚   â”‚
â”‚  â”‚ â˜ å°é€”å¾‘ (Right Route)     - æ ¸å°çµ¦è—¥é€”å¾‘               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Workflow Steps

| Step | Action | UI Element | Verification |
|------|--------|------------|--------------|
| 1 | æ¥æ”¶è—¥å“ from Runner | æƒæ DISPENSE_TICKET | HMAC verify |
| 2 | ç™»è¨˜å¾…çµ¦è—¥ | çµ¦è—¥ä½‡åˆ— | æ™‚é–“æ’ç¨‹ |
| 3 | å–è—¥ (ç¬¬ä¸€è®€) | Checklist | æƒæè—¥å“æ¢ç¢¼ |
| 4 | æ ¸å°ç—…æ‚£ | ç—…æ‚£ç¢ºèª | è©¢å•å§“å+ç”Ÿæ—¥ |
| 5 | æº–å‚™çµ¦è—¥ (ç¬¬äºŒè®€) | äº”å°ç¢ºèª | é€é …å‹¾é¸ |
| 6 | åŸ·è¡Œçµ¦è—¥ | çµ¦è—¥ç´€éŒ„ | - |
| 7 | å®Œæˆ (ç¬¬ä¸‰è®€) | ç¢ºèªå®Œæˆ | ç´€éŒ„åæ‡‰ |
| 8 | ç°½ç« ç´€éŒ„ | ADMIN_RECORD | è­·ç†å¸« ID |

#### ADMIN_RECORD Structure

```json
{
  "type": "ADMIN_RECORD",
  "version": "1.0",

  "admin_id": "ADM-NS01-20251222-0008",
  "dispense_id": "DISP-PHARM01-20251222-0015",
  "rx_id": "RX-DOC001-20251222-0042",

  "nurse_id": "NURSE-001",
  "nurse_name": "ç‹è­·ç†å¸«",

  "patient_ref": "***0042",

  "administered_items": [
    {
      "code": "MED-CEFTRI-1G",
      "name": "Ceftriaxone 1g",
      "qty_administered": 1,
      "route_verified": "IV",
      "site": "å·¦æ‰‹èƒŒ",
      "three_reads_completed": true,
      "five_rights_verified": true
    }
  ],

  "vitals_before": {
    "bp": "120/80",
    "pulse": 72,
    "temp": 37.5
  },

  "patient_response": "çµ¦è—¥é †åˆ©ï¼Œç„¡ä¸è‰¯åæ‡‰",
  "adverse_reaction": null,

  "administered_at": 1734858600,
  "ts": 1734858600,
  "hmac": "HMAC-SHA256..."
}
```

### 3.4 Runner (å¿—å·¥/é‹è¼¸è€…)

**Device**: Phone (camera app or dedicated Runner PWA)
**Authentication**: Volunteer badge QR or none

#### Transport Protocol

```
                    RUNNER TRANSPORT FLOW

      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚   Doctor     â”‚        â”‚   Pharmacy   â”‚        â”‚    Nurse     â”‚
      â”‚   Station    â”‚        â”‚   Station    â”‚        â”‚   Station    â”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                       â”‚                       â”‚
      1. Rx QR â”‚                      â”‚                       â”‚
         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚
             â”‚                       â”‚                       â”‚
             â”‚         2. Dispense   â”‚                       â”‚
             â”‚            Meds +     â”‚                       â”‚
             â”‚            Ticket QR  â”‚                       â”‚
             â”‚            â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
             â”‚                       â”‚                       â”‚
             â”‚                       â”‚    3. Return          â”‚
             â”‚                       â”‚    Confirmation       â”‚
             â”‚                       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
             â”‚                       â”‚                       â”‚
```

#### Runner Delivery Record

```json
{
  "type": "DELIVERY_RECORD",
  "version": "1.0",

  "delivery_id": "DEL-20251222-0023",
  "runner_id": "VOL-042",
  "runner_name": "é™³å¿—å·¥",

  "pickup": {
    "location": "è—¥å±€ç«™ A",
    "time": 1734856800,
    "items": ["DISP-PHARM01-20251222-0015"]
  },

  "dropoff": {
    "location": "è­·ç†ç«™ B",
    "time": 1734857400,
    "received_by": "NURSE-001"
  },

  "transport_conditions": {
    "cold_chain_maintained": true,
    "seal_intact": true
  },

  "notes": null
}
```

---

## 4. Emergency Medication Protocol (ç·Šæ€¥ç”¨è—¥)

### 4.1 Overview

In disaster scenarios, nurses may need to administer medication **before** obtaining a formal prescription. This is the **"use first, document later"** protocol.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EMERGENCY MEDICATION FLOW                         â”‚
â”‚                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚   â”‚   NURSE     â”‚  1. ç—…æ‚£ç·Šæ€¥éœ€è¦è—¥å“                               â”‚
â”‚   â”‚             â”‚  2. ç«‹å³çµ¦è—¥ (ç·Šæ€¥è—¥å“æ«ƒ)                          â”‚
â”‚   â”‚             â”‚  3. è¨˜éŒ„ EMERGENCY_ADMIN                          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚          â”‚                                                           â”‚
â”‚          â”‚ äº‹å¾Œè£œå–® (within 2 hours)                                 â”‚
â”‚          â–¼                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚   â”‚   DOCTOR    â”‚  4. å¯©æ ¸ç·Šæ€¥ç”¨è—¥                                  â”‚
â”‚   â”‚             â”‚  5. è£œé–‹è™•æ–¹ (RETRO_RX)                           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚          â”‚                                                           â”‚
â”‚          â–¼                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚   â”‚ PHARMACIST  â”‚  6. å¯©æ ¸ä¸¦ç¢ºèª                                    â”‚
â”‚   â”‚             â”‚  7. è¨˜éŒ„ RETRO_DISPENSE                           â”‚
â”‚   â”‚             â”‚  8. èª¿æ•´åº«å­˜                                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 EMERGENCY_ADMIN Structure

```json
{
  "type": "EMERGENCY_ADMIN",
  "version": "1.0",

  "emergency_id": "EMRG-NS01-20251222-0003",

  "nurse_id": "NURSE-001",
  "nurse_name": "ç‹è­·ç†å¸«",

  "patient_ref": "***0042",
  "patient_condition": "éæ•æ€§ä¼‘å…‹ï¼Œå‘¼å¸å›°é›£",

  "administered_items": [
    {
      "code": "MED-EPI-1MG",
      "name": "Epinephrine 1:1000 1mg/mL",
      "qty": 1,
      "route": "IM",
      "site": "å³å¤§è…¿å¤–å´"
    }
  ],

  "reason": "ANAPHYLAXIS",
  "reason_text": "èœ‚è«å¾Œåš´é‡éæ•åæ‡‰ï¼Œéœ€ç«‹å³çµ¦äºˆ Epinephrine",

  "administered_at": 1734860000,

  "vitals_at_admin": {
    "bp": "80/50",
    "pulse": 130,
    "spo2": 88,
    "consciousness": "æ¸…é†’ä½†ç„¦æ…®"
  },

  "outcome": "è¡€å£“å›å‡è‡³ 100/70ï¼Œå‘¼å¸æ”¹å–„",

  "requires_retro_rx": true,
  "retro_rx_deadline": 1734867200,

  "witness_id": "NURSE-002",
  "witness_name": "æ—è­·ç†å¸«",

  "ts": 1734860300,
  "hmac": "HMAC-SHA256..."
}
```

### 4.3 RETRO_RX (Retroactive Prescription)

Doctor creates after reviewing emergency use:

```json
{
  "type": "RETRO_RX",
  "version": "1.0",

  "rx_id": "RX-DOC001-20251222-0099-RETRO",
  "emergency_id": "EMRG-NS01-20251222-0003",

  "prescriber_id": "DOC-001",
  "prescriber_name": "ç‹å¤§æ˜é†«å¸«",

  "patient_ref": "***0042",

  "items": [
    {
      "code": "MED-EPI-1MG",
      "name": "Epinephrine 1:1000 1mg/mL",
      "qty": 1,
      "route": "IM",
      "retroactive": true
    }
  ],

  "clinical_justification": "éæ•æ€§ä¼‘å…‹ï¼Œç¬¦åˆç·Šæ€¥ç”¨è—¥æŒ‡å¼•",
  "reviewed_emergency_record": true,

  "ts": 1734862000,
  "signature": "Ed25519-Base64-Signature..."
}
```

### 4.4 Emergency Medication Categories

| Category | Examples | Allowed Without Prior Rx |
|----------|----------|--------------------------|
| **Anaphylaxis** | Epinephrine, Diphenhydramine | Yes |
| **Cardiac Arrest** | Epinephrine, Atropine, Amiodarone | Yes |
| **Seizure** | Diazepam, Lorazepam | Yes (single dose) |
| **Hypoglycemia** | Glucose 50%, Glucagon | Yes |
| **Acute Pain** | Acetaminophen, NSAIDs | Yes (non-controlled) |
| **Controlled Substances** | Morphine, Fentanyl | **No** - Doctor must be present |

---

## 5. Controlled Substance Special Handling

### 5.1 Double-Check Requirements

For Schedule II-IV controlled substances:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                CONTROLLED SUBSTANCE WORKFLOW                         â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    AT PHARMACY                                   â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ 1. Pharmacist #1: èª¿åŠ‘ä¸¦æ¸…é»æ•¸é‡                                 â”‚â”‚
â”‚  â”‚ 2. Pharmacist #2 (Witness): è¦†æ ¸æ¸…é»                             â”‚â”‚
â”‚  â”‚ 3. Both sign DISPENSE_RECORD                                     â”‚â”‚
â”‚  â”‚ 4. Log in controlled substance register                          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    AT NURSE STATION                              â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ 5. Nurse #1: ä¸‰è®€äº”å° verification                               â”‚â”‚
â”‚  â”‚ 6. Nurse #2 (Witness): è¦†æ ¸ä¸¦è¦‹è­‰çµ¦è—¥                            â”‚â”‚
â”‚  â”‚ 7. Both sign ADMIN_RECORD                                        â”‚â”‚
â”‚  â”‚ 8. Return unused to pharmacy (if any)                            â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Controlled Substance Audit Trail

```json
{
  "type": "CONTROLLED_AUDIT",
  "version": "1.0",

  "medication": {
    "code": "MED-MORPH-10",
    "name": "Morphine 10mg",
    "schedule": "II"
  },

  "opening_balance": 50,
  "closing_balance": 45,

  "transactions": [
    {
      "tx_id": "CTX-001",
      "type": "DISPENSE",
      "qty": -5,
      "rx_id": "RX-DOC001-20251222-0099",
      "patient_ref": "***0042",
      "dispensed_by": "PHARM-001",
      "witnessed_by": "PHARM-002",
      "ts": 1734862000
    }
  ],

  "audit_date": "2025-12-22",
  "auditor_id": "PHARM-001",
  "discrepancies": null
}
```

---

## 6. UI Flow Specifications

### 6.1 Nurse Station - ä¸‰è®€äº”å° Screen

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† è¿”å›        çµ¦è—¥ç¢ºèª        NURSE-001 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  ç—…æ‚£: ***0042 (è«‹å£é ­ç¢ºèªå§“å)          â”‚
â”‚                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                         â”‚
â”‚  ğŸ“‹ ä¸‰è®€ç¢ºèª                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â˜‘ ç¬¬ä¸€è®€ï¼šå–è—¥æ™‚å·²ç¢ºèª           â”‚   â”‚
â”‚  â”‚ â˜ ç¬¬äºŒè®€ï¼šæº–å‚™çµ¦è—¥å‰ç¢ºèª         â”‚   â”‚
â”‚  â”‚ â˜ ç¬¬ä¸‰è®€ï¼šçµ¦è—¥å¾Œç¢ºèª             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  âœ“ äº”å°æ ¸å°                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â˜‘ å°ç—…äºº - å·²ç¢ºèªç—…æ‚£èº«åˆ†        â”‚   â”‚
â”‚  â”‚ â˜‘ å°è—¥ç‰© - Ceftriaxone 1g       â”‚   â”‚
â”‚  â”‚ â˜‘ å°åŠ‘é‡ - 1 vial               â”‚   â”‚
â”‚  â”‚ â˜ å°æ™‚é–“ - 08:00 (ç¾åœ¨ 07:58)   â”‚   â”‚
â”‚  â”‚ â˜ å°é€”å¾‘ - IV (éœè„ˆæ³¨å°„)        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  æ³¨å°„éƒ¨ä½: [å·¦æ‰‹èƒŒ â–¼]                   â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚        âœ… ç¢ºèªå®Œæˆçµ¦è—¥           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  âš ï¸ ç®¡åˆ¶è—¥å“éœ€ç¬¬äºŒäººè¦‹è­‰                â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Emergency Medication Entry Screen

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        âš ï¸ ç·Šæ€¥ç”¨è—¥è¨˜éŒ„                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  âš¡ æ­¤è—¥å“å°‡åœ¨è™•æ–¹è£œé–‹å¾Œçµæ¡ˆ             â”‚
â”‚                                         â”‚
â”‚  ç—…æ‚£è­˜åˆ¥ç¢¼:                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ***0042                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  ç·Šæ€¥ç‹€æ³:                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â—‹ éæ•æ€§ä¼‘å…‹ (Anaphylaxis)       â”‚   â”‚
â”‚  â”‚ â—‹ å¿ƒè‡Ÿåœæ­¢ (Cardiac Arrest)      â”‚   â”‚
â”‚  â”‚ â—‹ ç™²ç™‡ç™¼ä½œ (Seizure)             â”‚   â”‚
â”‚  â”‚ â— å…¶ä»–: èœ‚è«éæ•åæ‡‰             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  ä½¿ç”¨è—¥å“:                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ” Epinephrine 1:1000           â”‚   â”‚
â”‚  â”‚    1 amp IM                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  ç”Ÿå‘½å¾µè±¡ (çµ¦è—¥ç•¶æ™‚):                    â”‚
â”‚  BP: [80/50] HR: [130] SpO2: [88%]     â”‚
â”‚                                         â”‚
â”‚  è¦‹è­‰äºº: [æ—è­·ç†å¸« NURSE-002]           â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚      ğŸ“ è¨˜éŒ„ç·Šæ€¥ç”¨è—¥             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  â° éœ€æ–¼ 2 å°æ™‚å…§è«‹é†«å¸«è£œé–‹è™•æ–¹          â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 Doctor Retroactive Rx Review Screen

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† è¿”å›      ç·Šæ€¥ç”¨è—¥å¯©æ ¸        DOC-001â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  âš¡ å¾…å¯©æ ¸ç·Šæ€¥ç”¨è—¥                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ EMRG-NS01-20251222-0003          â”‚   â”‚
â”‚  â”‚ 12:46 ä½¿ç”¨ï¼Œéœ€æ–¼ 14:46 å‰å¯©æ ¸     â”‚ âš â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                         â”‚
â”‚  ç—…æ‚£: ***0042                          â”‚
â”‚  è­·ç†å¸«: ç‹è­·ç†å¸« (NURSE-001)           â”‚
â”‚  è¦‹è­‰äºº: æ—è­·ç†å¸« (NURSE-002)           â”‚
â”‚                                         â”‚
â”‚  ç·Šæ€¥ç‹€æ³: éæ•æ€§ä¼‘å…‹                    â”‚
â”‚  æè¿°: èœ‚è«å¾Œåš´é‡éæ•åæ‡‰                â”‚
â”‚                                         â”‚
â”‚  ä½¿ç”¨è—¥å“:                              â”‚
â”‚  â€¢ Epinephrine 1:1000 1amp IM           â”‚
â”‚                                         â”‚
â”‚  çµ¦è—¥æ™‚ç”Ÿå‘½å¾µè±¡:                         â”‚
â”‚  BP: 80/50 | HR: 130 | SpO2: 88%        â”‚
â”‚                                         â”‚
â”‚  çµæœ: è¡€å£“å›å‡è‡³ 100/70ï¼Œå‘¼å¸æ”¹å–„       â”‚
â”‚                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                         â”‚
â”‚  é†«å¸«æ„è¦‹:                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ç¬¦åˆç·Šæ€¥ç”¨è—¥æŒ‡å¼•ï¼ŒåŒæ„è£œé–‹è™•æ–¹    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  âŒ é€€å›ä¿®æ”¹  â”‚ â”‚ âœ… ç°½ç« æ ¸å‡†   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. Data Sync Protocol

### 7.1 Report Aggregation

All clinical records are batched into encrypted reports for Hub sync:

```json
{
  "type": "CLINICAL_REPORT",
  "version": "1.0",

  "station_id": "PHARM-01",
  "report_period": {
    "from": 1734800000,
    "to": 1734886400
  },

  "records": {
    "dispense_records": [...],
    "admin_records": [...],
    "emergency_admins": [...],
    "retro_rx": [...],
    "controlled_audits": [...]
  },

  "summary": {
    "total_rx_processed": 42,
    "controlled_dispensed": 3,
    "emergency_uses": 1,
    "pending_retro_rx": 0
  },

  "ts": 1734886500,
  "encrypted_payload": "NaCl-Box-Encrypted...",
  "hmac": "HMAC-SHA256..."
}
```

### 7.2 Sync Priorities

| Record Type | Priority | Max Delay |
|-------------|----------|-----------|
| EMERGENCY_ADMIN | Critical | ASAP via Runner |
| Controlled Substance TX | High | 4 hours |
| DISPENSE_RECORD | Normal | 24 hours |
| ADMIN_RECORD | Normal | 24 hours |
| Inventory Updates | Low | 48 hours |

---

## 8. Security & Privacy

### 8.1 Patient Reference Masking

All patient identifiers are masked in transit and logs:

```
Full ID:    P0042-é™³å°è¯-M-35
Masked:     ***0042
Display:    *** + last 4 digits
```

### 8.2 Privacy Mode Toggle

Pharmacy and Nurse stations have a privacy toggle that:
- Blurs patient identifiers on screen
- Hides detailed medication names
- Shows only codes and quantities

### 8.3 Audit Log Requirements

All clinical actions must log:
- Who (operator ID)
- What (action type)
- When (timestamp)
- Where (station ID)
- For whom (masked patient ref)
- Verification status

---

## 9. Implementation Status

| Component | Status | Location |
|-----------|--------|----------|
| Doctor PWA | âœ… Done | `/frontend/doctor/` |
| Pharmacy PWA Base | âœ… Done | `/frontend/pharmacy/` |
| Pharmacy Rx Scan | â³ Pending | - |
| Pharmacy Dispense Flow | â³ Pending | - |
| Nurse Station PWA | â³ Pending | `/frontend/nurse/` (TBD) |
| Emergency Medication UI | â³ Pending | - |
| Retroactive Rx Flow | â³ Pending | - |
| Hub Clinical Reports | â³ Pending | - |

---

## 10. Appendix

### A. Frequency Reference (çµ¦è—¥é »ç‡)

| Code | English | ä¸­æ–‡ | Times/Day |
|------|---------|------|-----------|
| QD | Once daily | æ¯æ—¥ä¸€æ¬¡ | 1 |
| BID | Twice daily | æ¯æ—¥å…©æ¬¡ | 2 |
| TID | Three times daily | æ¯æ—¥ä¸‰æ¬¡ | 3 |
| QID | Four times daily | æ¯æ—¥å››æ¬¡ | 4 |
| Q4H | Every 4 hours | æ¯4å°æ™‚ | 6 |
| Q6H | Every 6 hours | æ¯6å°æ™‚ | 4 |
| Q8H | Every 8 hours | æ¯8å°æ™‚ | 3 |
| Q12H | Every 12 hours | æ¯12å°æ™‚ | 2 |
| PRN | As needed | éœ€è¦æ™‚ | - |
| STAT | Immediately | ç«‹å³ | - |
| HS | At bedtime | ç¡å‰ | 1 |
| AC | Before meals | é£¯å‰ | 3 |
| PC | After meals | é£¯å¾Œ | 3 |

### B. Route Reference (çµ¦è—¥é€”å¾‘)

| Code | English | ä¸­æ–‡ |
|------|---------|------|
| PO | By mouth | å£æœ |
| IV | Intravenous | éœè„ˆæ³¨å°„ |
| IM | Intramuscular | è‚Œè‚‰æ³¨å°„ |
| SC/SQ | Subcutaneous | çš®ä¸‹æ³¨å°„ |
| SL | Sublingual | èˆŒä¸‹ |
| TOP | Topical | å¤–ç”¨ |
| INH | Inhalation | å¸å…¥ |
| PR | Per rectum | è‚›é–€çµ¦è—¥ |
| OD | Right eye | å³çœ¼ |
| OS | Left eye | å·¦çœ¼ |
| OU | Both eyes | é›™çœ¼ |

### C. Emergency Medication Kit

Standard contents for disaster medical response:

| Medication | Indication | Route | Qty |
|------------|------------|-------|-----|
| Epinephrine 1:1000 | Anaphylaxis | IM | 10 amp |
| Epinephrine 1:10000 | Cardiac arrest | IV | 10 amp |
| Atropine 0.5mg | Bradycardia | IV | 10 amp |
| Diazepam 10mg | Seizure | IV/IM | 10 amp |
| Glucose 50% | Hypoglycemia | IV | 10 amp |
| Diphenhydramine 50mg | Allergic reaction | IM/IV | 10 amp |
| Dexamethasone 5mg | Severe allergy | IV | 10 amp |
| NTG 0.6mg | Chest pain | SL | 30 tab |
| Aspirin 100mg | MI | PO | 30 tab |

---

*Document Version: 1.0*
*Created: 2025-12-22*
*Supplements: xIRS_LITE_CPOE_SPEC_v1.0.md*
*Status: Draft - Pending Review*
